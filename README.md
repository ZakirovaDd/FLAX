# FLAX
Анализ вариаций копийности льна по данным высокопроизводительного секвенирования

Ход работы:
1. Первым шагом необходимо конвертировать все файлы из формата vcf в bed, с заданными столбцами.
Для этого загружаем папку со всеми файлами в нужную директорию, например, /home/YOUR_NAME/bcftools-1.9/
Запускаем команду

```
for t in /home/YOUR_NAME/bcftools-1.9/NAME_FOLDER/*
do 
         bcftools query -f'%CHROM\t%POS0\t%END\t%ID\n'  $t > $t.bed
done
```
Эта команда преобразует ваш файл и выдает выходные столбцы: CHROM, POS 0, END, ID.

2.	Плотность распределения длин вариантов (делеций и дупликаций)
Полученные файлы собираем в один и фильруем по нужным параметрам, в нашем случае по делеции/дупликации, также можно отфильровать по отдельной хромосоме
Код с файлом - mergefile1
Используя этот файл строим графики распределения плотности по хромомсомам в Rsudio:

```
ggplot(m, aes(x = len, group = V1)) + geom_line(stat = "density", aes(color = chromosome)) + theme_light() + labs(title ="Deletion",x="length", y="Density")+ coord_cartesian(xlim = c(0, 100000)) + scale_y_continuous(labels = scales::comma) + scale_x_continuous(limits = c(0, NA)) 
```
3. Построение графиков boxplot 
Аналогично с шагом 2, только в шаге 1 не учтен порядковый номер образца.
Для получения файла с пронумерованными образцами используем следующий код: boxplot1
